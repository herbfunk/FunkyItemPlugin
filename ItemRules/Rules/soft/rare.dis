// +--------------------------------------------------------------------------------------+
// |  ______ _______ ______ _______
// | |   __ \   _   |   __ \    ___|
// | |      <       |      <    ___|
// | |___|__|___|___|___|__|_______|
// | +++++++++++++++++++++++++++++++
// +--------------------------------------------------------------------------------------+

// keep all rare items
// this is a saftey line ... as long it isn't removed it will keep all items
// specifyed by the rule ... the action of commenting it out
// will apply all following rules ... this set of rules is no where of complete
//[QUALITY] == "Rare" -> [KEEP]

// keep all Weapon for now
//[QUALITY] == "Rare" && [BASETYPE] == "Weapon"

// keep all  "Armor"  for now
//[QUALITY] == "Rare" && [BASETYPE] == "Armor"

// keep all jewelerys for now
//[QUALITY] == "Rare" && [BASETYPE] == "Jewelry"


// +---------------------------------------------------------------------------+
// |  _______
// | |   |   |.---.-.----.----.-----.
// | |       ||  _  |  __|   _|  _  |
// | |__|_|__||___._|____|__| |_____|
// | ++++++++++++++++++++++++++++++++
// +---------------------------------------------------------------------------+

// Armor Damage Reduction = Armor/(50*Monster_Level + Armor)
//@ADR := [ARMORBONUS] / ((50*63) + [ARMORBONUS])

// Resistance Damage Reduction = Resistance/(5*Monster_Level + Armor)
//@RDR := ([ALLRES] + [MAXONERES] / 7) / ((5*63) + [@ADR])

// Total Damage Reduction = 1-(1-Armor Damage Reduction) * (1-Resistance Damage Reduction)
//@TDR := 1 - (1 - [@ADR]) * (1 - [@RDR])

// HP = Vitality * 35 // estimation is 1000 VIT
//@HP := (1000 + [VIT]) * (1 + [LIFE%]/100) * 35

// EHP = HP / (1-Total Damage Reduction)
//@EHP := [@HP] / (1 - [@TDR])

@EHP :=  ((1000 + [VIT]) * (1 + [LIFE%]/100) * 35) / (1 - (1 - (1 - ([ARMORBONUS] / ((50*63) + [ARMORBONUS]))) * (1 - (([ALLRES] + [MAXONERES] / 7) / ((5*63) + ([ARMORTOT] / ((50*63) + [ARMORTOT])))))))

// keep high @EHP armor items ...
//[QUALITY] == "Rare" && [BASETYPE] == "Armor" # [@EHP] > 60000

@OFFSTAT:=[AS%].dual+[CRIT%].dual+[CRITDMG%].dual+[MINDMG].dual+[MAXDMG].dual
@DEFSTAT:=[VIT].dual+[LIFE%].dual+[ALLRES].dual+[MS%].dual+[ARMORBONUS].dual+[LS%].dual+[LOH].dual+[REGEN].dual
@WIZSTAT:=[INT].dual+[MAXARCPOWER].dual+[ARCONCRIT].dual
@WITSTAT:=[INT].dual+[MAXMANA].dual+[MANAREG].dual
@MONSTAT:=[DEX].dual+[RESPHYSICAL].dual+[RESFIRE].dual+[RESCOLD].dual+[RESLIGHTNING].dual+[RESARCAN].dual+[RESPOISON].dual+[RESHOLY].dual+[HEALTHSPIRIT].dual+[MAXSPIRIT].dual+[SPIRITREG].dual
@DEMSTAT:=[DEX].dual+[HATREDREG].dual+[MAXDISCIP].dual
@BARSTAT:=[STR].dual+[MAXFURY].dual

// +---------------------------------------------------------------------------+
// |  ______ _______ _____   _______ _______      ______    ______
// | |   __ \   |   |     |_|    ___|     __|    |__    |  |      |
// | |      <   |   |       |    ___|__     |    |    __|__|  --  |
// | |___|__|_______|_______|_______|_______|    |______|__|______|
// | ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
// +---------------------------------------------------------------------------+
// Special rules (for safety)
// +---------------------------------------------------------------------------+
// TriFecta!
[QUALITY] == "Rare" # ([AS%] * [CRIT%] * [CRITDMG%]) > 0

// +---------------------------------------------------------------------------+
// |  _ _ _ _____ _____ _____ _____ _____ ______
// | | | | |   __|  _  |  _  |     |   | |    __|
// | | | | |   __|     |   __|  |  | | | |__    |
// | |_____|_____|__|__|__|  |_____|_|___|______|
// | +++++++++++++++++++++++++++++++++++++
// +---------------------------------------------------------------------------+
// +---------- One-Handed
// +---------------------------------------------------------------------------+
[QUALITY] == "Rare" && [BASETYPE] == "Weapon" && [ONEHAND] == true # [DPS] >= 2000 && [SOCKETS] > 0 && [MAXSTAT] >= 600 && ([LOH] >= 1400 || [LOK] >= 4000)

// +-----------------------------------------------------+
// +---------- Wand
// +---------- Class: Wizard
// +---------- Class: [ARCONCRIT] [MAXARCPOWER]
// +-----------------------------------------------------+
[QUALITY] == "Rare" && [TYPE] == "Wand" # [DPS] >= 2000 && [INT] >= 600 && [SOCKETS] > 0 && ([MAXARCPOWER] >= 10 || [ARCONCRIT] >= 8) && ([LOH] >= 1300 || [LOK] >= 4000)
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Wand" -> [TRASH]

// +-----------------------------------------------------+
// +---------- CeremonialDagger
// +---------- Class: Witch Doctor
// +---------- Class: [MAXMANA] [MANAREG]
// +-----------------------------------------------------+
[QUALITY] == "Rare" && [TYPE] == "CeremonialDagger" # [DPS] >= 2000 && [INT] >= 600 && [SOCKETS] > 0 && ([MAXMANA] >= 125 || [MANAREG] >= 12) && ([LOH] >= 1300 || [LOK] >= 4000)
// trash rule
[QUALITY] == "Rare" && [TYPE] == "CeremonialDagger" -> [TRASH]

// +-----------------------------------------------------+
// +---------- FistWeapon
// +---------- Class: Monk
// +---------- Class: 
// +-----------------------------------------------------+
// trash rule
[QUALITY] == "Rare" && [TYPE] == "FistWeapon" -> [TRASH]

// +-----------------------------------------------------+
// +---------- MightyWeapon
// +---------- Class: Barbarian
// +---------- Class: 
// +-----------------------------------------------------+
// trash rule
[QUALITY] == "Rare" && [TYPE] == "MightyWeapon" -> [TRASH]

// +-----------------------------------------------------+
// +---------- HandCrossbow
// +---------- Class: Demon Hunter
// +---------- Class: 
// +-----------------------------------------------------+
// trash rule
[QUALITY] == "Rare" && [TYPE] == "HandCrossbow" -> [TRASH]

// +-----------------------------------------------------+
// +---------- Axe, Dagger, Mace, Spear, Sword
// +-----------------------------------------------------+
// trash rule
[QUALITY] == "Rare" && [BASETYPE] == "Weapon" && [ONEHAND] == true -> [TRASH]

// +---------------------------------------------------------------------------+
// +---------- Two-Handed
// +---------------------------------------------------------------------------+
[QUALITY] == "Rare" && [BASETYPE] == "Weapon" && [TWOHAND] == true # [DPS] > 2700 && [MAXSTAT] >= 900 && [SOCKETS] > 0 && ([LOH] >= 3000 || [LOK] >= 6000)

// +-----------------------------------------------------+
// +---------- Staff
// +-----------------------------------------------------+
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Staff" -> [TRASH]

// +-----------------------------------------------------+
// +---------- Polearm
// +-----------------------------------------------------+
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Polearm" -> [TRASH]

// +-----------------------------------------------------+
// +---------- Crossbow
// +-----------------------------------------------------+
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Crossbow" -> [TRASH]

// +-----------------------------------------------------+
// +---------- Bow
// +-----------------------------------------------------+
[QUALITY] == "Rare" && [TYPE] == "Bow" # [DPS] >= 3500 && [DEX] >= 600 && [SOCKETS] > 0 &&
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Bow" -> [TRASH]

// +-----------------------------------------------------+
// +---------- MightyWeapon
// +---------- Class: Barbarian
// +---------- Class: 
// +-----------------------------------------------------+
// trash rule
[QUALITY] == "Rare" && [TYPE] == "MightyWeapon" && [TWOHAND] == true -> [TRASH]

// +-----------------------------------------------------+
// +---------- Daibo
// +---------- Class: Monk
// +---------- Class: 
// +-----------------------------------------------------+
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Daibo" -> [TRASH]

// +-----------------------------------------------------+
// +---------- Axe, Mace, Sword
// +-----------------------------------------------------+
// trash rule
[QUALITY] == "Rare" && [BASETYPE] == "Weapon" && [TWOHAND] == true -> [TRASH]

// +---------------------------------------------------------------------------+
// +---------- Ranged
// +---------------------------------------------------------------------------+


// +---------------------------------------------------------------------------+
// |  _____ _____ _____ _____ _____
// | |  _  | __  |     |     | __  |
// | |     |    -| | | |  |  |    -|
// | |__|__|__|__|_|_|_|_____|__|__|
// | +++++++++++++++++++++++++++++++
// +---------------------------------------------------------------------------+
// +---------- Head
// +---------------------------------------------------------------------------+
// | OFF: [INT] == 300, [STR] == 200, [DEX] == 200, [CRIT%] == 6,
// | DEF: [VIT] == 200, [LIFE%] == 12, [ALLRES] == 80, [MAXONERES] == 60, [ARMOR] == 397
// | ADD: [SOCKETS] == 1, [REGEN] == 342, [GF%] == 25, [MF%] == 20
// +---------------------------------------------------------------------------+
[QUALITY] == "Rare" && [TYPE] == "Helm" # [MAXSTAT] >= 600 && [VIT] >= 600 && [CRIT%] >= 5 && (([ALLRES] >= 86 || [LIFE%] > 11) || [SOCKETS] >= 1)
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Helm" -> [TRASH]

// +-----------------------------------------------------+
// +---------- WizardHat
// +-- Class: [ARCONCRIT] == 10, [MAXARCPOWER] == 15
// +-----------------------------------------------------+
[QUALITY] == "Rare" && [TYPE] == "WizardHat" # [MAXSTAT] >= 600 && [VIT] >= 600 && [CRIT%] >= 5 && (([ALLRES] >= 86 || [LIFE%] > 11) || [SOCKETS] >= 1)
// trash rule
[QUALITY] == "Rare" && [TYPE] == "WizardHat" -> [TRASH]

// +-----------------------------------------------------+
// +---------- VoodooMask
// +-- Class: [MAXMANA] == 150, [MANAREG] == 14
// +-----------------------------------------------------+
[QUALITY] == "Rare" && [TYPE] == "VoodooMask" # [MAXSTAT] >= 600 && [VIT] >= 600 && [CRIT%] >= 5 && (([ALLRES] >= 86 || [LIFE%] > 11) || [SOCKETS] >= 1)
// trash rule
[QUALITY] == "Rare" && [TYPE] == "VoodooMask" -> [TRASH]

// +-----------------------------------------------------+
// +---------- SpiritStone
// +-----------------------------------------------------+
// trash rule
[QUALITY] == "Rare" && [TYPE] == "SpiritStone" -> [TRASH]

// +---------------------------------------------------------------------------+
// | -- Shoulders
// +---------------------------------------------------------------------------+
[QUALITY] == "Rare" && [TYPE] == "Shoulder" # [MAXSTAT] > 400 && [VIT] > 400 && [ALLRES] > 86 && [LIFE%] > 11
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Shoulder" -> [TRASH]

// +---------------------------------------------------------------------------+
// | -- Torso
// +---------------------------------------------------------------------------+

// +---------------------------------------------------------------------------+
// |---------- Chest
// +---------------------------------------------------------------------------+
//[QUALITY] == "Rare" && [TYPE] == "Chest" # ([MAXSTAT] >= 400 && [VIT] >= 400 && ([ALLRES] >= 86 || [SOCKETS] >=3))
[QUALITY] == "Rare" && [TYPE] == "Chest" # [MAXSTAT] > 400 && [VIT] > 400 && [ALLRES] >= 86 && [SOCKETS] > 2
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Chest" -> [TRASH]

// +---------------------------------------------------------------------------+
// +---------- Cloak
// +---------------------------------------------------------------------------+
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Cloak" -> [TRASH]

// +---------------------------------------------------------------------------+
// | -- Wrists
// +---------------------------------------------------------------------------+

// +-----------------------------------------------------+
// |---------- Bracers
// +-----------------------------------------------------+
//[QUALITY] == "Rare" && [TYPE] == "Bracer" # ([MAXSTAT] >= 400 && ([TOTRES] >= 55 || [VIT] >= 400) && [CRIT%] >= 6)
[QUALITY] == "Rare" && [TYPE] == "Bracer" # [MAXSTAT] > 400 && [VIT] > 400 && [CRIT%] >= 6 && ([LOH] >= 1350 || [ALLRES] >= 55)
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Bracer" -> [TRASH]

// +---------------------------------------------------------------------------+
// | -- Hands
// +---------------------------------------------------------------------------+

// +-----------------------------------------------------+
// |---------- Gloves
// +-----------------------------------------------------+
[QUALITY] == "Rare" && [TYPE] == "Gloves" # [MAXSTAT] >= 550 && [CRIT%] >= 8 && [AS%] >= 5 && [CRITDMG%] >= 40
// For rerolling:
[QUALITY] == "Rare" && [TYPE] == "Gloves" # [MAXSTAT] >= 580 && [CRIT%] >= 8 && [AS%] >= 5
[QUALITY] == "Rare" && [TYPE] == "Gloves" # [MAXSTAT] >= 580 && [CRIT%] >= 8 && [CRITDMG%] >= 40
[QUALITY] == "Rare" && [TYPE] == "Gloves" # [MAXSTAT] >= 580 && [AS%] >= 5 && [CRITDMG%] >= 40
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Gloves" -> [TRASH]

// +---------------------------------------------------------------------------+
// | -- Waist
// +---------------------------------------------------------------------------+

// +-----------------------------------------------------+
// |---------- Belt
// +-----------------------------------------------------+
[QUALITY] == "Rare" && [TYPE] == "Belt" # [MAXSTAT] >= 400 && [VIT] >= 400 && [ALLRES] >= 86 && [LIFE%] > 11
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Belt" -> [TRASH]

// +-----------------------------------------------------+
// | -- MightyBelt
// +-----------------------------------------------------+
[QUALITY] == "Rare" && [TYPE] == "MightyBelt" # [MAXSTAT] >= 400 && [VIT] >= 400 && [ALLRES] >= 86 && [LIFE%] > 11
// trash rule
[QUALITY] == "Rare" && [TYPE] == "MightyBelt" -> [TRASH]

// +---------------------------------------------------------------------------+
// | -- Legs
// +---------------------------------------------------------------------------+
[QUALITY] == "Rare" && [TYPE] == "Legs" # [MAXSTAT] > 400 && [VIT] > 400 && [ALLRES] > 86 && [SOCKETS] > 1
//For rerolling:
[QUALITY] == "Rare" && [TYPE] == "Legs" # [MAXSTAT] > 400 && [VIT] > 400 && [ALLRES] > 86 && [ARMORBONUS] > 1
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Legs" -> [TRASH]

// +---------------------------------------------------------------------------+
// | -- Feet
// +---------------------------------------------------------------------------+
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Boots" -> [TRASH]

// +---------------------------------------------------------------------------+
// |  _____ _____ _____     _____ _____ _____ ____
// | |     |   __|   __|___|  |  |  _  |   | |    \
// | |  |  |   __|   __|___|     |     | | | |  |  |
// | |_____|__|  |__|      |__|__|__|__|_|___|____/
// | +++++++++++++++++++++++++++++++++++++++++++++++
// +---------------------------------------------------------------------------+
// | -- Shields
// +---------------------------------------------------------------------------+
//[QUALITY] == "Rare" && [TYPE] == "Shield" # [MAXSTATVIT] > 300 && [CRIT%] > 9 && [ALLRES] > 69 && ([LIFE%] >= 12 || [BLOCK%] >= 9 || ([GF%] >= 25 && [MF%] >= 20))
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Shield" -> [TRASH]

// +---------------------------------------------------------------------------+
// | -- Mojos
// +---------------------------------------------------------------------------+
[QUALITY] == "Rare" && [TYPE] == "Mojo" # [INT] >= 600 && [AVGDMG] >= 340 && [CRIT%] >= 9 && ([MAXMANA] >= 100 || [MANAREG] >= 10 || [LIFE%] >= 12 || [SOCKETS] > 0)
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Mojo" -> [TRASH]

// +---------------------------------------------------------------------------+
// | -- Orbs
// +---------------------------------------------------------------------------+
[QUALITY] == "Rare" && [TYPE] == "Orb" # [INT] >= 600 && [AVGDMG] >= 340 && [CRIT%] >= 9 && ([ARCONCRIT] >= 10 || [MAXARCPOWER] >= 15 || [LIFE%] >= 12 || [SOCKETS] > 0)
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Orb" -> [TRASH]

// +---------------------------------------------------------------------------+
// | -- Quivers
// +---------------------------------------------------------------------------+
[QUALITY] == "Rare" && [TYPE] == "Quiver" # [DEX] > 600 && [AS%] >= 15 && [CRIT%] >= 8 && ([MAXDISCIP] >= 9 || [HATREDREG] > 1 || [LIFE%] >= 10)
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Quiver" -> [TRASH]

// +---------------------------------------------------------------------------+
// |     __ _____ _ _ _ _____ __    _____ __ __
// |  __|  |   __| | | |   __|  |  | __  |  |  |
// | |  |  |   __| | | |   __|  |__|    -|_   _|
// | |_____|_____|_____|_____|_____|__|__| |_|
// | +++++++++++++++++++++++++++++++++++++++++++
// +---------------------------------------------------------------------------+
// | -- Amulet
// +---------------------------------------------------------------------------+
[QUALITY] == "Rare" && [TYPE] == "Amulet" # [MAXSTAT] >= 550 && [CRIT%] >= 7 && [CRITDMG%] >= 70 && ([AS%] >= 5 || [AVGDMG] > 60)
// For rerolling:
[QUALITY] == "Rare" && [TYPE] == "Amulet" # [MAXSTAT] >= 575 && [CRIT%] >= 8 && [CRITDMG%] >= 80
[QUALITY] == "Rare" && [TYPE] == "Amulet" # [MAXSTAT] >= 575 && [CRIT%] >= 8 && [AS%] >= 6
[QUALITY] == "Rare" && [TYPE] == "Amulet" # [MAXSTAT] >= 575 && [AS%] >= 6 && [CRITDMG%] >= 80
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Amulet" -> [TRASH]

// +---------------------------------------------------------------------------+
// | -- Ring
// +---------------------------------------------------------------------------+
[QUALITY] == "Rare" && [TYPE] == "Ring" # [MAXSTAT] >= 360 && [CRIT%] >= 4 && [CRITDMG%] >= 30 && ([VIT] >= 350 || [ALLRES] >= 60 || [AS%] > 4 || [AVGDMG] > 70)
[QUALITY] == "Rare" && [TYPE] == "Ring" # [MAXSTAT] >= 370 && [CRIT%] >= 5 && [CRITDMG%] >= 40
// For rerolling:
[QUALITY] == "Rare" && [TYPE] == "Ring" # [MAXSTAT] >= 390 && [CRIT%] >= 5 && [AS%] >= 6
[QUALITY] == "Rare" && [TYPE] == "Ring" # [MAXSTAT] >= 390 && [CRITDMG%] >= 40 && [AS%] >= 6 
// trash rule
[QUALITY] == "Rare" && [TYPE] == "Ring" -> [TRASH]

// +---------------------------------------------------------------------------+
// | -- FollowerSpecial
// +---------------------------------------------------------------------------+
[QUALITY] == "Rare" && [TYPE] == "FollowerSpecial" # [MAXSTAT] >= 600 && [VIT] > 500 && [ALLRES] >= 50 && [CRITDMG%] >= 90
// trash rule
[QUALITY] == "Rare" && [TYPE] == "FollowerSpecial" -> [TRASH]

// +---------------------------------------------------------------------------+
// |   ___ _____ _   _ _____ ____    ____ _____ _   _ _____ _____ 
// |  / _ \_   _| | | | ____|  _ \  / ___|_   _| | | |  ___|  ___|
// | | | | || | | |_| |  _| | |_) | \___ \ | | | | | | |_  | |_   
// | | |_| || | |  _  | |___|  _ <   ___) || | | |_| |  _| |  _|  
// |  \___/ |_| |_| |_|_____|_| \_\ |____/ |_|  \___/|_|   |_|    
// | +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
// +---------------------------------------------------------------------------+
[QUALITY] == "Rare" && [NAME] == "Death's Breath"
[QUALITY] == "Rare" && [NAME] == "Rift Keystone Fragment"

// +---------------------------------------------------------------------------+
// | _____ _____ _____ _____ _____
// ||_   _| __  |  _  |   __|  |  |
// |  | | |    -|     |__   |     |
// |  |_| |__|__|__|__|_____|__|__|
// | ++++++++++++++++++++++++++++++
// +---------------------------------------------------------------------------+
// Sells all items if rules above are not met
[QUALITY] == "Rare" && [BASETYPE] == "Weapon" -> [TRASH]
[QUALITY] == "Rare" && [BASETYPE] == "Armor" -> [TRASH]
[QUALITY] == "Rare" && [BASETYPE] == "Jewelry" -> [TRASH]